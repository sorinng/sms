<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>ê°€ì¥ ì‰¬ìš´ ë¬¸ì ë³´ë‚´ê¸°</title>

<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>

<style>
body {
  font-family: "Pretendard", "Malgun Gothic", sans-serif;
}
</style>
</head>

<body class="bg-gray-100 min-h-screen p-4">

<div class="max-w-3xl mx-auto bg-white shadow-xl rounded-xl p-6">

  <!-- HEADER -->
  <h1 class="text-3xl font-extrabold text-center mb-6">ğŸ“± ê°€ì¥ ì‰¬ìš´ ë¬¸ì ë³´ë‚´ê¸°</h1>

  <!-- ë²ˆí˜¸/ë¬¸ì ê°œìˆ˜ í‘œì‹œ -->
  <div class="grid grid-cols-2 gap-4 mb-6">

    <div>
      <h2 class="font-semibold">í•¸ë“œí° ë²ˆí˜¸ (<span id="phoneCount">0</span>ê°œ)</h2>
      <textarea id="phoneInput" class="w-full h-32 p-3 border rounded-lg focus:ring-2 focus:ring-blue-500"
        placeholder="01011112222&#10;01033334444"></textarea>
    </div>

    <div>
      <h2 class="font-semibold">ë¬¸ìë‚´ìš© (<span id="msgCount">0</span>ê°œ)</h2>
      <textarea id="msgInput" class="w-full h-32 p-3 border rounded-lg focus:ring-2 focus:ring-blue-500"
        placeholder="ì•ˆë…•í•˜ì„¸ìš”&#10;ë©”ì‹œì§€ì…ë‹ˆë‹¤"></textarea>
    </div>

  </div>

  <!-- ë²„íŠ¼ ìƒì„± -->
  <button id="makeBtn"
    class="w-full bg-green-600 hover:bg-green-700 text-white py-3 rounded-lg shadow-lg text-lg font-semibold">
    ë¬¸ì ë³´ë‚´ê¸° ë²„íŠ¼ ë§Œë“¤ê¸° (ì„œë²„ ì €ì¥ ì—†ìŒ)
  </button>

  <!-- QR ìœ„ì¹˜ -->
  <div id="qrArea" class="my-6 text-center"></div>

  <!-- ë²„íŠ¼ ë¦¬ìŠ¤íŠ¸ -->
  <div id="sendButtons" class="space-y-3"></div>

  <!-- ì•ˆë‚´ -->
  <div class="mt-8 p-4 bg-gray-100 rounded-xl text-sm leading-relaxed">
    <p>ğŸ“Œ ìŠ¤ë§ˆíŠ¸í°ì—ì„œ <b>ë³´ë‚´ê¸°</b> ë²„íŠ¼ì„ í´ë¦­í•˜ë©´ ë¬¸ìë³´ë‚´ê¸° í™”ë©´ìœ¼ë¡œ ì „í™˜ë©ë‹ˆë‹¤.<br>
    PCì—ì„œëŠ” ë¬¸ìì•±ì´ ì—†ê¸° ë•Œë¬¸ì— ì‘ë™í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</p>
  </div>

</div>

<script>
// -----------------------------
// ì¤„ ê°œìˆ˜ ê³„ì‚°
// -----------------------------
function countLines(text) {
  return text.split("\n").filter(v => v.trim() !== "").length;
}

function updateCounts() {
  document.getElementById("phoneCount").innerText = countLines(phoneInput.value);
  document.getElementById("msgCount").innerText = countLines(msgInput.value);
}

document.getElementById("phoneInput").addEventListener("input", updateCounts);
document.getElementById("msgInput").addEventListener("input", updateCounts);

// -----------------------------
// ë²„íŠ¼ ìƒì„±
// -----------------------------
document.getElementById("makeBtn").onclick = () => {
  
  const phones = phoneInput.value.split("\n").map(v => v.trim()).filter(v=>v);
  const msgs   = msgInput.value.split("\n").map(v => v.trim()).filter(v=>v);

  if (phones.length === 0 || msgs.length === 0) {
    alert("ë²ˆí˜¸ì™€ ë¬¸ìë¥¼ ì…ë ¥í•˜ì„¸ìš”.");
    return;
  }

  // ë©”ì‹œì§€ ìˆ˜ì™€ ë²ˆí˜¸ ìˆ˜ê°€ ë‹¤ë¥´ë©´ ì•„ì£¼ë°©ì²˜ëŸ¼ íŒì—…
  if (msgs.length !== phones.length) {
    const answer = confirm(
      "ë™ì¼í•œ ë©”ì‹œì§€ë¥¼ ì—¬ëŸ¬ ë²ˆí˜¸ì— ë³´ë‚¼ê¹Œìš”?\n\ní™•ì¸: ë™ì¼ ë©”ì‹œì§€ ë°˜ë³µ\nì·¨ì†Œ: ë²ˆí˜¸ë³„ ë‹¤ë¥¸ ë©”ì‹œì§€ ë§¤ì¹­"
    );

    if (answer) {
      // ë™ì¼ ë©”ì‹œì§€ë¡œ ë‹¨ì²´ ë°œì†¡
      while (msgs.length < phones.length) msgs.push(msgs[0]);
    } else {
      // ê°œë³„ ë§¤ì¹­ì¸ë° ê¸¸ì´ê°€ ë‹¤ë¥´ë©´ ë¶ˆê°€
      if (msgs.length !== phones.length) {
        alert("ë²ˆí˜¸ ìˆ˜ì™€ ë©”ì‹œì§€ ìˆ˜ê°€ ì¼ì¹˜í•´ì•¼ ê°œë³„ ë°œì†¡ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.");
        return;
      }
    }
  }

  // ë³´ë‚´ê¸° ë²„íŠ¼ ë§Œë“¤ê¸°
  const area = document.getElementById("sendButtons");
  area.innerHTML = "";

  phones.forEach((p, i) => {
    const msg = msgs[i];

    const btn = document.createElement("button");
    btn.className = "w-full bg-blue-600 hover:bg-blue-700 text-white py-3 rounded-lg shadow text-lg font-semibold";
    btn.innerHTML = `[${i+1}] ${p} &nbsp; âœ ë³´ë‚´ê¸°`;

    btn.onclick = () => {
      const smsURL = `sms:${p}?body=${encodeURIComponent(msg)}`;
      window.location.href = smsURL;

      // í´ë¦­ í›„ ì•„ì£¼ë°©ì²˜ëŸ¼ ë²„íŠ¼ ì‚­ì œ
      btn.style.display = "none";
    };

    area.appendChild(btn);
  });

  // QR ìƒì„± (í˜„ì¬ í˜ì´ì§€ URL)
  createQR();

};

// -----------------------------
// QR ìƒì„±
// -----------------------------
function createQR() {
  const qrDiv = document.getElementById("qrArea");
  qrDiv.innerHTML = "";

  const q = document.createElement("div");
  q.id = "qrcode";
  qrDiv.appendChild(q);

  new QRCode(q, {
    text: window.location.href,
    width: 200,
    height: 200
  });
}
</script>

</body>
</html>
