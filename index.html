<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>ê°€ì¥ ì‰¬ìš´ ë¬¸ì ë³´ë‚´ê¸°</title>

<!-- Tailwind -->
<script src="https://cdn.tailwindcss.com"></script>

<!-- QRCode -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>

<style>
body {
  font-family: "Pretendard", "Malgun Gothic", sans-serif;
}
</style>
</head>

<body class="bg-gray-100 min-h-screen p-4">

<!-- ë©”ì¸ ì»¨í…Œì´ë„ˆ -->
<div class="max-w-3xl mx-auto bg-white shadow-xl rounded-xl p-6">

  <!-- ì œëª© -->
  <h1 class="text-3xl font-extrabold text-center mb-6">ğŸ“± ê°€ì¥ ì‰¬ìš´ ë¬¸ì ë³´ë‚´ê¸°</h1>

  <!-- ë²ˆí˜¸/ë¬¸ì ì…ë ¥ -->
  <div class="grid grid-cols-2 gap-4 mb-6">

    <!-- ì „í™”ë²ˆí˜¸ ì…ë ¥ -->
    <div>
      <h2 class="font-semibold mb-1">í•¸ë“œí° ë²ˆí˜¸ (<span id="phoneCount">0</span>ê°œ)</h2>
      <textarea id="phoneInput"
        class="w-full h-32 p-3 border rounded-lg focus:ring-2 focus:ring-blue-500"
        placeholder="01011112222&#10;01033334444"></textarea>
    </div>

    <!-- ë©”ì‹œì§€ ì…ë ¥ -->
    <div>
      <h2 class="font-semibold mb-1">ë¬¸ìë‚´ìš© (<span id="msgCount">0</span>ê°œ)</h2>
      <textarea id="msgInput"
        class="w-full h-32 p-3 border rounded-lg focus:ring-2 focus:ring-blue-500"
        placeholder="ì•ˆë…•í•˜ì„¸ìš”&#10;ë©”ì‹œì§€ì…ë‹ˆë‹¤"></textarea>
    </div>

  </div>

  <!-- ë²„íŠ¼ ìƒì„± -->
  <button id="makeBtn"
    class="w-full bg-green-600 hover:bg-green-700 text-white py-3 rounded-lg shadow-lg text-lg font-semibold mb-6">
    ë¬¸ì ë³´ë‚´ê¸° ë²„íŠ¼ ë§Œë“¤ê¸° (ì„œë²„ ì €ì¥ ì—†ìŒ)
  </button>

  <!-- QR ë‚˜íƒ€ë‚˜ëŠ” ê³³ -->
  <div id="qrArea" class="my-6 text-center"></div>

  <!-- ë³´ë‚´ê¸° ë²„íŠ¼ ë¦¬ìŠ¤íŠ¸ -->
  <div id="sendButtons" class="space-y-3"></div>

  <!-- ì•ˆë‚´ -->
  <div class="mt-8 p-4 bg-gray-100 rounded-xl text-sm leading-relaxed">
    ğŸ“Œ ìŠ¤ë§ˆíŠ¸í°ì—ì„œ <b>ë³´ë‚´ê¸°</b> ë²„íŠ¼ì„ í´ë¦­í•˜ë©´ ë¬¸ìë³´ë‚´ê¸° í™”ë©´ìœ¼ë¡œ ì „í™˜ë©ë‹ˆë‹¤.  
    <br>PCì—ì„œëŠ” ë¬¸ìì•±ì´ ì—†ê¸° ë•Œë¬¸ì— ì‘ë™í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
  </div>

</div>

<script>
// -----------------------------
// ì¤„ ê°œìˆ˜ ì¹´ìš´íŠ¸
// -----------------------------
function countLines(text) {
  return text.split("\n").filter(v => v.trim() !== "").length;
}

function updateCounts() {
  phoneCount.innerText = countLines(phoneInput.value);
  msgCount.innerText = countLines(msgInput.value);
}

phoneInput.addEventListener("input", updateCounts);
msgInput.addEventListener("input", updateCounts);


// -----------------------------
// ë¬¸ì ë³´ë‚´ê¸° ë²„íŠ¼ ìƒì„±
// -----------------------------
document.getElementById("makeBtn").onclick = () => {

  const phoneArr = phoneInput.value.split("\n").map(v => v.trim()).filter(v => v);
  const msgArr   = msgInput.value.split("\n").map(v => v.trim()).filter(v => v);

  if (phoneArr.length === 0 || msgArr.length === 0) {
    alert("ë²ˆí˜¸ì™€ ë¬¸ìë¥¼ ì…ë ¥í•˜ì„¸ìš”.");
    return;
  }

  // ë©”ì‹œì§€ ê°œìˆ˜ ë¶ˆì¼ì¹˜ â†’ ì•„ì£¼ë°©ì²˜ëŸ¼ íŒì—…
  if (phoneArr.length !== msgArr.length) {

    const isSame = confirm(
      "ë™ì¼í•œ ë©”ì‹œì§€ë¥¼ ë°˜ë³µí•´ì„œ ë³´ë‚´ì‹œë ¤ë©´ 'í™•ì¸'ì„ ì„ íƒí•˜ì„¸ìš”.\n" +
      "ê°œë³„ì ìœ¼ë¡œ ë³´ë‚´ë ¤ë©´ 'ì·¨ì†Œ'ë¥¼ ì„ íƒí•˜ì„¸ìš”."
    );

    if (isSame) {
      // ë™ì¼ ë©”ì‹œì§€ ë°˜ë³µ
      const msg = msgArr[0];
      msgArr.length = 0;
      phoneArr.forEach(() => msgArr.push(msg));

    } else {
      // ê°œë³„ë§¤ì¹­ì¸ë° ê°œìˆ˜ê°€ ë‹¤ë¥´ë©´ ì˜¤ë¥˜
      if (msgArr.length !== phoneArr.length) {
        alert("ê°œë³„ ë°œì†¡ì€ ë²ˆí˜¸ ìˆ˜ì™€ ë©”ì‹œì§€ ìˆ˜ê°€ ë™ì¼í•´ì•¼ í•©ë‹ˆë‹¤.");
        return;
      }
    }
  }

  // ë²„íŠ¼ ë¦¬ìŠ¤íŠ¸ ìƒì„±
  const area = document.getElementById("sendButtons");
  area.innerHTML = "";

  phoneArr.forEach((p, i) => {
    const msg = msgArr[i];

    const btn = document.createElement("button");
    btn.className =
      "w-full bg-blue-600 hover:bg-blue-700 text-white py-3 rounded-lg shadow text-lg font-semibold";
    btn.innerHTML = `[${i+1}] ${p} â†’ ë³´ë‚´ê¸°`;

    btn.onclick = () => {
      const smsURL = `sms:${p}?body=${encodeURIComponent(msg)}`;
      window.location.href = smsURL;
      btn.style.display = "none";
    };

    area.appendChild(btn);
  });

  // QR ìƒì„±
  generateQR();
};


// -----------------------------
// QR ì½”ë“œ ìƒì„± (ê³ ì • URLë§Œ ì‚¬ìš©)
// -----------------------------
function generateQR() {

  // GitHub Pages ê³ ì • URL
  const fixedURL = "https://sorinng.github.io/sms/";

  const qrArea = document.getElementById("qrArea");
  qrArea.innerHTML = `
    <h3 class="text-lg font-semibold mb-3">QR ì½”ë“œë¡œ ì ‘ì†í•˜ì„¸ìš”</h3>
    <div id="qrcode" class="flex justify-center"></div>
  `;

  new QRCode(document.getElementById("qrcode"), {
    text: fixedURL,   //  â† ë°˜ë“œì‹œ ê³ ì • URLë§Œ ì‚¬ìš© (í•µì‹¬ í¬ì¸íŠ¸!)
    width: 200,
    height: 200
  });
}
</script>

</body>
</html>
