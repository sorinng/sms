<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>ê°€ì¥ ì‰¬ìš´ ë¬¸ì ë³´ë‚´ê¸°</title>

<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>

<style>
body { background:#f4f4f4; font-family: "Pretendard","Malgun Gothic",sans-serif; }
.card { background:white; padding:24px; border-radius:18px; box-shadow:0 4px 20px rgba(0,0,0,0.08); }
.label { font-size:15px; font-weight:600; color:#333; margin-bottom:6px; }
.input-box { width:70%; margin:auto; border:1px solid #ddd; border-radius:10px; padding:12px; font-size:15px; display:block; }
.qr-btn { width:70%; margin:auto; background:#4a7afe; color:white; padding:14px; font-size:18px; border-radius:12px; font-weight:700; display:block; }
.qr-btn:hover { background:#2455ea; }
.big-send-btn { width:100%; background:#4a7afe; color:white; padding:40px; font-size:36px; border-radius:20px; font-weight:800; }
.big-send-btn:hover { background:#2455ea; }
.qr-title { font-size:18px; font-weight:700; margin-bottom:12px; text-align:center; }
.hidden-area { display:none; }
</style>
</head>

<body class="p-5">

<div class="max-w-3xl mx-auto card">

<h1 class="text-3xl font-extrabold mb-8 text-center">ğŸ“± ê°€ì¥ ì‰¬ìš´ ë¬¸ì ë³´ë‚´ê¸°</h1>

<div id="inputArea">

<div class="mb-6 text-center">
  <div class="label text-left" style="width:70%; margin:auto;">í•¸ë“œí° ë²ˆí˜¸ (<span id="phoneCount">0</span>ê°œ)</div>
  <textarea id="phoneInput" class="input-box h-40" placeholder="01012345678&#10;01098765432"></textarea>
</div>

<div class="mb-8 text-center">
  <div class="label text-left" style="width:70%; margin:auto;">ë¬¸ìë‚´ìš© (í•œ ê°œì˜ ë©”ì‹œì§€ë¡œ ì²˜ë¦¬)</div>
  <textarea id="msgInput" class="input-box h-32" placeholder="ì•ˆë…•í•˜ì„¸ìš”. ë¬¸ì ë°œì†¡ ì•ˆë‚´ë“œë¦½ë‹ˆë‹¤."></textarea>
</div>

<button id="makeQR" class="qr-btn mb-8">QR ì½”ë“œ ìƒì„± (ë²ˆí˜¸/ë¬¸ì í¬í•¨)</button>

<div id="qrArea" class="text-center"></div>

</div>

<div id="sendButtons" class="space-y-4 mt-6"></div>

<div class="mt-10 text-sm text-gray-600 leading-relaxed">
  ìŠ¤ë§ˆíŠ¸í°ì—ì„œ QRì„ ìŠ¤ìº”í•˜ë©´ ë²ˆí˜¸Â·ë¬¸ìê°€ ìë™ ì…ë ¥ë˜ê³ 
  ì‚¬ëŒë³„ ë³´ë‚´ê¸° ë²„íŠ¼ì´ ìë™ ìƒì„±ë©ë‹ˆë‹¤.
</div>

</div>

<script>

function countLines(t){ return t.split("\n").filter(v=>v.trim()).length; }
function updateCounts(){ phoneCount.innerText = countLines(phoneInput.value); }
phoneInput.addEventListener("input", updateCounts);

document.getElementById("makeQR").onclick = () => {
  const phones = phoneInput.value.split("\n").map(v=>v.trim()).filter(v=>v);
  const msg = msgInput.value.trim();

  if(phones.length===0 || msg.length===0){
    alert("ë²ˆí˜¸ì™€ ë¬¸ìë¥¼ ì…ë ¥í•˜ì„¸ìš”.");
    return;
  }

  const msgs = phones.map(()=>msg);

  const pParam = encodeURIComponent(phones.join(","));
  const mParam = encodeURIComponent(msgs.join("||"));

  const finalURL = `https://sorinng.github.io/sms/?p=${pParam}&m=${mParam}`;

  const qrDiv = document.getElementById("qrArea");
  qrDiv.innerHTML = `<div class="qr-title">QR ì½”ë“œë¡œ ì ‘ì†í•˜ì„¸ìš”</div><div id="qrcode"></div>`;

  new QRCode(document.getElementById("qrcode"), {
    text: finalURL,
    width: 230,
    height: 230
  });
};

function getParam(name){
  const url = new URL(window.location.href);
  return url.searchParams.get(name);
}

function createSendButtons(phones,msgs){
  const area = document.getElementById("sendButtons");
  area.innerHTML="";

  phones.forEach((p,i)=>{
    const msg = msgs[i];

    const btn=document.createElement("button");
    btn.className="big-send-btn";
    btn.innerHTML=`${p}<br><span style="font-size:22px;">ë©”ì‹œì§€ ë³´ë‚´ê¸°</span>`;

    btn.onclick=()=>{
      const smsURL=`sms:${p}?body=${encodeURIComponent(msg)}`;
      window.location.href=smsURL;
      btn.style.display="none";
    };

    area.appendChild(btn);
  });
}

window.addEventListener("DOMContentLoaded",()=>{
  const p=getParam("p");
  const m=getParam("m");

  if(!p||!m) return;

  document.getElementById("inputArea").classList.add("hidden-area");

  const phones=decodeURIComponent(p).split(",");
  const msgs=decodeURIComponent(m).split("||");

  createSendButtons(phones,msgs);
});

</script>

</body>
</html>
