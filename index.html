<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>ğŸ“± ë¬¸ì ë³´ë‚´ê¸° ğŸ“±</title>

<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>

<style>
body { background:#f4f4f4; font-family:"Pretendard","Malgun Gothic",sans-serif; font-size:20px; }
.card { background:white; padding:30px; border-radius:20px; box-shadow:0 4px 20px rgba(0,0,0,0.1); text-align:center; }

.label { font-size:20px; font-weight:700; color:#333; margin-bottom:8px; text-align:center; }

.input-box {
  width:50%;
  border:1px solid #ddd;
  border-radius:12px;
  padding:15px;
  font-size:20px;
  margin:auto;
  display:block;
}

.big-btn {
  width:100%;
  background:#4a7afe;
  color:white;
  padding:18px;
  font-size:24px;
  border-radius:14px;
  font-weight:700;
}

.big-btn:hover { background:#2455ea; }

.qr-title { font-size:22px; font-weight:800; margin-bottom:14px; text-align:center; }
.hidden-area { display:none; }

#sendButtons button {
  font-size:24px;
  padding:20px;
  border-radius:18px;
}
</style>
</head>

<body class="p-5 flex justify-center items-center">

<div class="max-w-3xl w-full mx-auto card">

<h1 class="text-4xl font-extrabold mb-10 text-center">ğŸ“± ë¬¸ì ë³´ë‚´ê¸° ğŸ“±</h1>

<div id="inputArea">

<div class="mb-10">
  <div class="label">í•¸ë“œí° ë²ˆí˜¸ (<span id="phoneCount">0</span>ê°œ)</div>
  <textarea id="phoneInput" class="input-box h-48" placeholder="01012345678&#10;01098765432"></textarea>
</div>

<div class="mb-10">
  <div class="label">ë¬¸ìë‚´ìš© (í•œ ê°œì˜ ë©”ì‹œì§€)</div>
  <textarea id="msgInput" class="input-box h-40" placeholder="ì•ˆë…•í•˜ì„¸ìš”. ë¬¸ì ë°œì†¡ ì•ˆë‚´ë“œë¦½ë‹ˆë‹¤."></textarea>
</div>

<button id="makeQR" class="big-btn mb-10">QR ì½”ë“œ ìƒì„± (ë²ˆí˜¸/ë¬¸ì í¬í•¨)</button>

<div id="qrArea" class="text-center"></div>

</div>

<div id="sendButtons" class="space-y-6 mt-10"></div>

<div class="mt-12 text-gray-700 text-lg leading-relaxed">
  ìŠ¤ë§ˆíŠ¸í°ì—ì„œ QRì„ ìŠ¤ìº”í•˜ë©´ ë²ˆí˜¸Â·ë¬¸ìê°€ ìë™ ì…ë ¥ë˜ê³ <br>
  ì‚¬ëŒë³„ ë³´ë‚´ê¸° ë²„íŠ¼ì´ ìë™ ìƒì„±ë©ë‹ˆë‹¤.
</div>

</div>

<script>

function countLines(t){ return t.split("\n").filter(v=>v.trim()).length; }
function updateCounts(){ phoneCount.innerText = countLines(phoneInput.value); }
phoneInput.addEventListener("input", updateCounts);

document.getElementById("makeQR").onclick = () => {
  const phones = phoneInput.value.split("\n").map(v=>v.trim()).filter(v=>v);
  const msg = msgInput.value.trim();

  if(phones.length===0 || msg.length===0){
    alert("ë²ˆí˜¸ì™€ ë¬¸ìë¥¼ ì…ë ¥í•˜ì„¸ìš”.");
    return;
  }

  const msgs = phones.map(()=>msg);

  const pParam = encodeURIComponent(phones.join(","));
  const mParam = encodeURIComponent(msgs.join("||"));

  const finalURL = `https://sorinng.github.io/sms/?p=${pParam}&m=${mParam}`;

  const qrDiv = document.getElementById("qrArea");
  qrDiv.innerHTML = `<div class="qr-title">QR ì½”ë“œë¡œ ì ‘ì†í•˜ì„¸ìš”</div><div id="qrcode"></div>`;

  new QRCode(document.getElementById("qrcode"), {
    text: finalURL,
    width: 260,
    height: 260
  });
};

function getParam(name){
  const url = new URL(window.location.href);
  return url.searchParams.get(name);
}

function createSendButtons(phones,msgs){
  const area = document.getElementById("sendButtons");
  area.innerHTML="";

  phones.forEach((p,i)=>{
    const msg = msgs[i];

    const btn=document.createElement("button");
    btn.className="big-btn";
    btn.innerHTML=`ğŸ“¨ [${i+1}] ${p} â†’ ë¬¸ì ë³´ë‚´ê¸°`;

    btn.onclick=()=>{
      const smsURL=`sms:${p}?body=${encodeURIComponent(msg)}`;
      window.location.href=smsURL;
      btn.style.display="none";
    };

    area.appendChild(btn);
  });
}

window.addEventListener("DOMContentLoaded",()=>{
  const p=getParam("p");
  const m=getParam("m");

  if(!p||!m) return;

  document.getElementById("inputArea").classList.add("hidden-area");

  const phones=decodeURIComponent(p).split(",");
  const msgs=decodeURIComponent(m).split("||");

  createSendButtons(phones,msgs);
});

</script>

</body>
</html>
